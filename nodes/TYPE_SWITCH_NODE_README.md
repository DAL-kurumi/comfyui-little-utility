# 類型切換節點 (Type Switch Nodes)

## 概述

提供兩個類型轉換節點，可以在**文字 (STRING)**、**整數 (INT)**、**小數 (FLOAT)** 之間進行轉換。

---

## 1. 類型切換節點 (Type Switch Node)

### 功能說明

手動選擇輸出類型的類型轉換節點。

### 輸入參數

#### 數據輸入（全部可選，優先級：文字 > 整數 > 小數）

- **text_input** (可選): 文字輸入 - 連接方式
- **int_input** (可選): 整數輸入 - 連接方式
- **float_input** (可選): 小數輸入 - 連接方式

#### 控制參數

- **output_type** (可選): 目標輸出類型
  - 選項：`STRING` / `INT` / `FLOAT`
  - 預設：`STRING`

### 輸出

- **文字輸出**: 當 output_type = "STRING" 時有效
- **整數輸出**: 當 output_type = "INT" 時有效
- **小數輸出**: 當 output_type = "FLOAT" 時有效

### 優先級規則

如果同時連接了多個輸入，節點會按以下優先級選擇：

1. **文字輸入** (最高優先級)
2. **整數輸入** (中等優先級)
3. **小數輸入** (最低優先級)

### 使用範例

#### 範例 1: 整數轉文字

```
輸入:
  int_input: 42 (連接)
  output_type: STRING

輸出:
  文字輸出: "42"
```

#### 範例 2: 文字轉整數

```
輸入:
  text_input: "123" (連接)
  output_type: INT

輸出:
  整數輸出: 123
```

#### 範例 3: 小數轉整數

```
輸入:
  float_input: 3.14 (連接)
  output_type: INT

輸出:
  整數輸出: 3
```

#### 範例 4: 優先級測試

```
輸入:
  text_input: "100" (連接)
  int_input: 200 (連接)
  float_input: 300.5 (連接)
  output_type: STRING

結果:
  選擇文字輸入 "100"（優先級最高）
  輸出: "100"
```

---

## 2. 類型切換自動節點 (Type Switch Auto Node)

### 功能說明

自動輸出所有類型轉換結果的節點，無需手動選擇輸出類型。

### 輸入參數

#### 數據輸入（全部可選，優先級：文字 > 整數 > 小數）

- **text_input** (可選): 文字輸入 - 連接方式
- **int_input** (可選): 整數輸入 - 連接方式
- **float_input** (可選): 小數輸入 - 連接方式

**注意**: 此節點沒有 output_type 選項

### 輸出

**同時輸出所有三種類型**：

- **文字**: 轉換為字符串的結果
- **整數**: 轉換為整數的結果
- **小數**: 轉換為浮點數的結果

### 使用範例

#### 範例 1: 一次性獲取所有類型

```
輸入:
  int_input: 42 (連接)

輸出:
  文字: "42"
  整數: 42
  小數: 42.0
```

#### 範例 2: 文字轉換

```
輸入:
  text_input: "3.14" (連接)

輸出:
  文字: "3.14"
  整數: 3
  小數: 3.14
```

---

## 轉換規則

### STRING → INT

- 純數字字串：`"123"` → `123`
- 包含小數點：`"3.14"` → `3`（先轉 float，再取整）
- 無效字串：`"abc"` → `0`（默認值）

### STRING → FLOAT

- 數字字串：`"3.14"` → `3.14`
- 整數字串：`"42"` → `42.0`
- 無效字串：`"abc"` → `0.0`（默認值）

### INT → STRING

- 直接轉換：`42` → `"42"`

### INT → FLOAT

- 直接轉換：`42` → `42.0`

### FLOAT → STRING

- 直接轉換：`3.14` → `"3.14"`

### FLOAT → INT

- 截斷小數：`3.14` → `3`
- 截斷小數：`3.99` → `3`

---

## 節點結構示意

### 類型切換節點 (手動選擇)

```
┌───────────────────────┐
│   Type Switch Node    │
├───────────────────────┤
│ text_input:   ○───    │ ← 優先級 1
│ int_input:    ○───    │ ← 優先級 2
│ float_input:  ○───    │ ← 優先級 3
│ output_type: [STRING] │ ← 手動選擇
├───────────────────────┤
│ ───○ 文字輸出         │
│ ───○ 整數輸出         │
│ ───○ 小數輸出         │
└───────────────────────┘
```

### 類型切換自動節點

```
┌───────────────────────┐
│  Type Switch Auto     │
├───────────────────────┤
│ text_input:   ○───    │ ← 優先級 1
│ int_input:    ○───    │ ← 優先級 2
│ float_input:  ○───    │ ← 優先級 3
├───────────────────────┤
│ ───○ 文字             │ ← 自動輸出
│ ───○ 整數             │ ← 自動輸出
│ ───○ 小數             │ ← 自動輸出
└───────────────────────┘
```

---

## 實際應用場景

### 場景 1: 處理混合類型的數據流

```
[文字節點] ──> text_input
[整數節點] ──> int_input  ──> [Type Switch] ──> 統一輸出文字
[小數節點] ──> float_input      (STRING)
```

### 場景 2: 數學計算前的類型轉換

```
[文字節點 "42"] ──> [Type Switch] ──> [數學運算節點]
                      output: INT
```

### 場景 3: 多類型輸出

```
[整數節點 42] ──> [Type Switch Auto] ──┬──> 文字給顯示節點
                                      ├──> 整數給計算節點
                                      └──> 小數給其他節點
```

### 場景 4: 動態類型選擇

```
[用戶輸入] ──> text_input
              int_input   ──> [Type Switch]
              float_input      output_type 由工作流決定
```

---

## 錯誤處理

節點會自動處理轉換錯誤：

| 情況             | 處理方式                      |
| ---------------- | ----------------------------- |
| 無效的字串轉整數 | 返回 `0`                      |
| 無效的字串轉小數 | 返回 `0.0`                    |
| 沒有任何輸入     | 返回默認值 (`""`, `0`, `0.0`) |
| 轉換異常         | 返回默認值並在控制台輸出警告  |

---

## 調試信息

兩個節點都會在控制台輸出詳細信息：

```
==================================================
類型切換節點執行中...
目標輸出類型: INT
✓ 選擇文字輸入: 123
來源類型: STRING
→ 轉換為整數: 123
==================================================
```

---

## 選擇建議

### 使用 Type Switch Node 當...

- ✅ 需要精確控制輸出類型
- ✅ 只需要一種類型的輸出
- ✅ 想要節省計算資源

### 使用 Type Switch Auto Node 當...

- ✅ 需要同時使用多種類型
- ✅ 不確定下游節點需要什麼類型
- ✅ 想要最大的靈活性

---

## 注意事項

⚠️ **重要提醒**：

- 所有數據輸入必須通過連接，不能手動輸入
- 如果同時連接多個輸入，會按優先級自動選擇（文字 > 整數 > 小數）
- 浮點數轉整數會**截斷小數部分**，不是四捨五入
- 字串轉換失敗會返回默認值（0 或 0.0），不會報錯
- output_type 選項可以在節點屬性中修改

---

## 更新時間

2025-12-23
